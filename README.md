<img width="904" height="647" alt="snapshot_20260221_134445_bc" src="https://github.com/user-attachments/assets/91ee64c0-d035-434c-8d26-5a877b1e761e" />

---

# DTMerger 取扱説明書（ユーザーガイド）

## 1. 概要

**DTMerger** は、**DocuWorks 文書（.xdw）** と **TIFF 画像（.tif / .tiff）** をひとつにまとめ、**マルチページ TIFF** として出力するアプリです。

- DocuWorks 文書は **400 dpi** の TIFF 画像に変換したうえで結合します。
- ファイルは **ドラッグ＆ドロップ（DnD）** でリストに追加できます。

---

## 2. 動作条件（前提）

- **Windows PC**
- **DocuWorks がインストールされていること（必須）**  
  DocuWorks 文書（.xdw）の変換に DocuWorks 環境が必要です。

---

## 3. 対応ファイル

- DocuWorks 文書：`*.xdw`
- TIFF 画像：`*.tif`, `*.tiff`

---

## 4. 画面の見かた（主な要素）

画面は大きく次の要素で構成されます。

- **ファイル一覧（リスト）**  
  追加したファイル（およびページ）が表示されます。例：`説明書.xdw-p001` / `図面.tif-p003` など
- **↑ / ↓（並び替え）**  
  選択中の項目を上／下に移動します。  
  ※ 出力される TIFF のページ順は **このリストの順番** に従います。
- **出力ボタン**
  - **G4形式で出力**
  - **LZW形式で出力**
- **クリア**  
  リストの内容をクリアします。

---

## 5. 使い方（基本手順）

### 5.1 ファイルを追加する（DnD）

1. エクスプローラーから、結合したい `*.xdw` / `*.tif` / `*.tiff` を選びます。
2. DTMerger の **ファイル一覧** に **ドラッグ＆ドロップ** します。
3. ファイルがリストに追加されます。

> ヒント：複数ファイルをまとめて DnD できます（Windows の標準操作に準じます）。

---

### 5.2 順番を整える（↑ / ↓）

1. リスト内の項目をクリックして選択します。
2. 右側の **↑ / ↓** を押して、ページ順を調整します。

---

### 5.3 TIFFとして出力する（G4 / LZW）

1. 出力したい順番になっていることを確認します。
2. 目的に応じて、次のいずれかのボタンを押します。
   - **G4形式で出力**：2値の白黒画像として保存されます（図面・文書向け）
   - **LZW形式で出力**：カラー画像として保存されます

---

### 5.4 保存場所
1. 出力ファイルは、**リスト先頭のファイルと同じフォルダー**に、ファイル名の末尾へ **_mrg** のサフィックスが付加されて自動保存されます。

---

## 6. 変換仕様（重要）

### 6.1 DocuWorks 文書の変換
- DocuWorks 文書（.xdw）は、各ページを **400 dpi** の TIFF 画像に変換してから結合します。

### 6.2 出力される TIFF
- 出力は **1つのマルチページ TIFF** です。
- ページ順は **画面のリスト順** です。

---

## 7. よくあるトラブルと対処

### 7.1 DocuWorks が入っていない／変換できない
- 症状：`.xdw` を追加・出力したときにエラーになる、変換されない  
- 対処：
  - **DocuWorks がインストールされているか**確認してください。
  - DocuWorks がインストールされていても問題が出る場合、DocuWorks を一度起動して動作確認を行ってください。

### 7.2 DnD で追加できない
- 症状：ドラッグしても反応しない  
- 対処：
  - 管理者権限で起動しているアプリには、通常権限のエクスプローラーから DnD できない場合があります。  
    **DTMerger とエクスプローラーの権限（管理者／通常）を揃える**ことで改善することがあります。

---

## 8. 注意事項

- DocuWorks 文書の変換解像度は **400 dpi 固定**です。
- 本アプリは **DocuWorks環境に依存**します。DocuWorksの状態（設定やインストール状況）により、変換結果や動作が影響を受ける場合があります。

---

